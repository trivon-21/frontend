<header class="topbar">
  <div class="topbar-inner">
    <a routerLink="/" class="brand">AirLux</a>

    <div class="search">
      <span class="search-icon">üîç</span>
      <input type="text" placeholder="Search" />
    </div>

    <nav class="navlinks">
      <a href="#">View products</a>
      <a routerLink="/" fragment="services">Our Services</a>
      <a href="#">About Us</a>
    </nav>

    <!-- Guest buttons -->
    <div class="authbtns" *ngIf="!currentUser">
      <a routerLink="/login" class="btn ghost">Log in</a>
      <a routerLink="/signup" class="btn solid">Sign up</a>
    </div>

    <!-- Logged-in user area -->
    <div class="user-area" *ngIf="currentUser">
      <a routerLink="/dashboard" class="btn dashboard-btn">Dashboard</a>
      <div class="user-menu" (clickOutside)="closeDropdown()">
        <button class="avatar-btn" (click)="toggleDropdown()" aria-label="User menu">
          <div class="avatar">{{ getInitials(currentUser.fullName) }}</div>
          <span class="user-name">{{ currentUser.fullName.split(' ')[0] }}</span>
          <svg class="chevron" [class.open]="showDropdown" viewBox="0 0 24 24" width="14" height="14">
            <path d="M6 9l6 6 6-6" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
          </svg>
        </button>

        <div class="dropdown" *ngIf="showDropdown">
          <div class="dropdown-header">
            <div class="avatar avatar-lg">{{ getInitials(currentUser.fullName) }}</div>
            <div>
              <div class="dropdown-name">{{ currentUser.fullName }}</div>
              <div class="dropdown-email">{{ currentUser.email }}</div>
            </div>
          </div>
          <div class="dropdown-divider"></div>
          <a routerLink="/dashboard" class="dropdown-item" (click)="closeDropdown()">
            <svg viewBox="0 0 24 24" width="16" height="16"><rect x="3" y="3" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="1.8"/><rect x="14" y="3" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="1.8"/><rect x="3" y="14" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="1.8"/><rect x="14" y="14" width="7" height="7" rx="1" fill="none" stroke="currentColor" stroke-width="1.8"/></svg>
            My Dashboard
          </a>
          <a href="#" class="dropdown-item" (click)="closeDropdown()">
            <svg viewBox="0 0 24 24" width="16" height="16"><circle cx="12" cy="8" r="4" fill="none" stroke="currentColor" stroke-width="1.8"/><path d="M4 20c0-4 3.6-7 8-7s8 3 8 7" fill="none" stroke="currentColor" stroke-width="1.8" stroke-linecap="round"/></svg>
            My Profile
          </a>
          <a href="#" class="dropdown-item" (click)="closeDropdown()">
            <svg viewBox="0 0 24 24" width="16" height="16"><path d="M9 5H7a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2V7a2 2 0 0 0-2-2h-2" fill="none" stroke="currentColor" stroke-width="1.8"/><rect x="9" y="3" width="6" height="4" rx="1" fill="none" stroke="currentColor" stroke-width="1.8"/></svg>
            My Services
          </a>
          <div class="dropdown-divider"></div>
          <button class="dropdown-item logout-item" (click)="logout()">
            <svg viewBox="0 0 24 24" width="16" height="16"><path d="M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4" fill="none" stroke="currentColor" stroke-width="1.8"/><polyline points="16 17 21 12 16 7" fill="none" stroke="currentColor" stroke-width="1.8"/><line x1="21" y1="12" x2="9" y2="12" stroke="currentColor" stroke-width="1.8"/></svg>
            Sign out
          </button>
        </div>
      </div>
    </div>
  </div>
</header>
